<%@ page language="java" import="java.util.*" pageEncoding="gb2312"%>
<%@page import="java.util.ArrayList"%>
<%@page import="java.util.List"%>
<%@page contentType="text/html; charset=gb2312"%>
<%@page import="com.gemfor.mvc.valueobject.UserInfo" %>
<%@page import="com.gemfor.mvc.valueobject.VOClassData" %>
<%@ include file="/public/common.jsp" %>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title>Left_index</title>

   
    <script type="text/javascript" src="<%=basePath%>/js/mtmcode.js"></script>
    
    
    <script type="text/javascript">
	MTMDefaultTarget = "text";
	
	/******************************************************************************
	* User-configurable list of icons.                                            *
	******************************************************************************/
	
	var MTMIconList = null;
	MTMIconList = new IconList();
	//MTMIconList.addIcon(new MTMIcon("menu_link_external.gif", "http://", "pre"));
	//MTMIconList.addIcon(new MTMIcon("menu_link_pdf.gif", ".pdf", "post"));
	
	/******************************************************************************
	* User-configurable menu.                                                     *
	******************************************************************************/
	
	// Main menu.
	var menu = null;
	menu = new MTMenu();
</script>
    <meta content="Microsoft Visual Studio .NET 7.0" name="GENERATOR">
    <meta content="Visual Basic 7.0" name="CODE_LANGUAGE">
    <meta content="JavaScript" name="vs_defaultClientScript">
    <meta content="http://schemas.microsoft.com/intellisense/ie5" name="vs_targetSchema">
    <script>
			<!--
			
			function hrefOnClick(local) 
			{
				window.parent.frames[3].location.href = local;
			}
				function MM_reloadPage(init) {  //reloads the window if Nav4 resized
				  if (init==true) with (navigator) {if ((appName=="Netscape")&&(parseInt(appVersion)==4)) {
				    document.MM_pgW=innerWidth; document.MM_pgH=innerHeight; onresize=MM_reloadPage; }}
				  else if (innerWidth!=document.MM_pgW || innerHeight!=document.MM_pgH) location.reload();
				}
				MM_reloadPage(true);
				
				function MM_findObj(n, d) { //v4.01
				  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
				    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
				  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
				  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
				  if(!x && d.getElementById) x=d.getElementById(n); return x;
				}
				
				function MM_showHideLayers() { //v6.0
				  var i,p,v,obj,args=MM_showHideLayers.arguments;
				  for (i=0; i<(args.length-2); i+=3) if ((obj=MM_findObj(args[i]))!=null) { v=args[i+2];
				    if (obj.style) { obj=obj.style; v=(v=='show')?'visible':(v=='hide')?'hidden':v; }
				    obj.visibility=v; }
				}
				
				function MM_swapImgRestore() { //v3.0
				  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
				}
				
				function MM_preloadImages() { //v3.0
				  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
				    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
				    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
				}
				
				function MM_swapImage() { //v3.0
				  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
				   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
				}
			//-->
    </script>
<style type="text/css">
A:link { color: #006699; background: #ffffff; font-family:Arial, Helvetica, sans-serif; font-size:84%; text-decoration:none; background:transparent;}
A:active { color: #990000; background: #ffffff; font-family:Arial, Helvetica, sans-serif; font-size:84%; text-decoration:none; background:transparent;}
A:visited { color: #006699; background: #ffffff;  font-family:Arial, Helvetica, sans-serif;font-size:84%; text-decoration:none; background:transparent;}
A:hover { color: #990000; background: #ffffff; font-family:Arial, Helvetica, sans-serif;font-size:84%; text-decoration:none; background:transparent;}
</style>	

	
	
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
</head>
<body onload="MTMStartMenu(true);" class="left_bg" >
<%		
		String pre_menuMain = "menuMain";
		String menuID = "";
		String menuName = "";
		String vSecondLevel = "N" ;
		String vCurrParent = "";
		String vCurrSubParent = "";
		java.util.List mainMenuList = new ArrayList();
		String menuID_respond = (String) request.getAttribute("menuID");
		
		
		if ((menuID_respond != null) && (!menuID_respond.equals(""))){
			menuID = menuID_respond.substring(pre_menuMain.length());
		} 

		UserInfo userinfo = (UserInfo)request.getSession().getAttribute("userInfo");
		if (userinfo == null){
			return;
		}
		java.util.Map classDatasMap = userinfo.getClassDataS();
		String key = null;
		java.util.List valueList = null;
		
		java.util.Vector menuMain = (java.util.Vector)classDatasMap.get("menuMain");
		if(menuMain == null){
			return;
		}
		System.out.println(menuMain);
		
		java.util.Iterator iter = menuMain.iterator();
		while(iter.hasNext()){
			java.util.Vector temp = (java.util.Vector)iter.next();
			mainMenuList.add(temp);
		}
		
		
		
		
		
	/* 	if ((classDatasMap != null) && (classDatasMap.size() > 0)){
			java.util.Iterator keyIterator = classDatasMap.entrySet().iterator();
			while(keyIterator.hasNext()){
				java.util.Map.Entry entry = (java.util.Map.Entry)keyIterator.next();
				key = entry.getKey().toString(); 
				if (key.equalsIgnoreCase("menuMain")){
					java.util.Vector menuVector = (java.util.Vector)entry.getValue();
					
					if ((menuVector != null) && (menuVector.size() > 0)){
						java.util.Iterator itMenu = menuVector.iterator();
						while (itMenu.hasNext()){
							java.util.Vector vTemp = (java.util.Vector)itMenu.next();
							
							if ((menuID_respond == null) || (menuID_respond.equals(""))){
								
								menuID = vTemp.get(1).toString();
								menuName = vTemp.get(2).toString();
								
								break;
							}
							if (menuID.equalsIgnoreCase(vTemp.get(1).toString())){
								menuName = vTemp.get(2).toString();
							}
							
						}
					}
					break;
				}
			}
			keyIterator = classDatasMap.entrySet().iterator();
			while(keyIterator.hasNext()){
				java.util.Map.Entry entry = (java.util.Map.Entry)keyIterator.next();
				key = entry.getKey().toString(); 
				if (key.equalsIgnoreCase(menuID)){
					valueList = (java.util.List)entry.getValue();
					break;
				}			
			}
		}
		 */
		
		
	%>
    <table width="180px" border="0">
        
        <tr>
            <td>


                <script language='JavaScript'>
	//foldersTree = gFld('¹¦ÄÜ²Ëµ¥', '');
	
/* menu.addItem("Company Masters", "");
var submenu = null;
submenu = new MTMenu();
submenu.addItem("Installation Company", "");
menu.makeLastSubmenu(submenu); */

 	
	<%if(mainMenuList != null && mainMenuList.size() > 0) {
		 for(int i = 0; i < mainMenuList.size(); i++){
		 	java.util.Vector temp = (java.util.Vector)mainMenuList.get(i);
		 	vCurrParent = (String)temp.get(1);
		 	vSecondLevel = "N" ;
		 	System.out.println("MainMenu   £ºName ------>" + temp.get(2));
		 	System.out.println("MainMenu   £º      ID ------>" + temp.get(1));
	%>	
		 	//******************************************************************************
		// JavaScript code - 
		menu.addItem("<% out.print(temp.get(2));%>", "<% out.print(basePath+"/GemFor?command=indexmenuMain"+temp.get(1));%>");
		var submenu = null;
		submenu = new MTMenu();
		//******************************************************************************
		
		
		
		

		
		
		
		
		
		
		<%
				
				java.util.List subMenu1 = (java.util.List)userinfo.getClassDataS().get(temp.get(1));
				
				for(int j = 0; j < subMenu1.size(); j ++){
					
					VOClassData classData = new VOClassData();
					classData = (VOClassData)subMenu1.get(j);
					vCurrSubParent = classData.getClassID();
					System.out.println("SubMenu   £º  id  ------>" + classData.getClassID());
					System.out.println("SubMenu   £ºfid  ------>" + classData.getSelfDiv());
					System.out.println("SubMenu   £ºname ------>" + classData.getClassName());
					if ((vCurrParent != null) && (classData.getSelfDiv() != null) && (vCurrParent.equals (classData.getSelfDiv())))
					{
						vSecondLevel = "Y" ;
						
					%>
					submenu.addItem("<%out.print(classData.getClassName());%>", "<%out.print(basePath+"/GemFor?command="+classData.getUrl());%>");
					
					if (submenu != null){
						menu.makeLastSubmenu(submenu);
					}
					
<%
				}
		}
	}
	}
%>
	 

				
		
                </script>





<%-- <SCRIPT language="JavaScript">

<%
	// Main 'for' loop for constructing menu tree
	for(int i = 0; i < vLevel1.size(); i++) {
		String sGroup1[] = new String [7] ;
   		sGroup1 = (String []) vLevel1.get(i) ;
   		vCurrParent = sGroup1[1] ;
   		vSecondLevel = "N" ;
%>
		//******************************************************************************
		// JavaScript code - 
		menu.addItem("<% out.print(sGroup1[2]);%>", "<% out.print("");%>");
		var submenu = null;
		submenu = new MTMenu();
		//******************************************************************************

<%	
		for(int j = 0; j < vLevel2.size(); j++) {
			String sGroup2[] = new String[7] ;
			sGroup2 = (String[]) vLevel2.get(j) ;
			vCurrSubParent = sGroup2[1] ;
			if ((vCurrParent != null) && (sGroup2[3] != null) && (vCurrParent.equals (sGroup2[3])))
			{
				vSecondLevel = "Y" ;

%>
				//******************************************************************************
				// JavaScript code - 
				submenu.addItem("<% out.print(sGroup2[2]);%>", "");
				var submenu2 = null;
				submenu2 = new MTMenu();
				//******************************************************************************
<%				
				for(int k = 0; k < vLevel3.size(); k++) {
					 String sGroup3[] = new String[7] ;
					 sGroup3 = (String[]) vLevel3.get(k) ;
		
					 if ((vCurrSubParent != null) && (sGroup3[3] != null) && (vCurrSubParent.equals (sGroup3[3]))) {
						int iii= 0 ;
						iii = sGroup3[4].indexOf ("parent.tr.location=") ;
						if (iii == 0) iii = 21 ;
						if (iii < 0) iii = 0 ;
						vLink1 = sGroup3[4].substring (iii) ;
						if (iii == 21) 
							vLink1 = vLink1.substring (0, (vLink1.length ()- 2)) ;
%>
						//******************************************************************************
						// JavaScript code - 
						//submenu2.addItem("<%out.print(sGroup3[2]);%>", "<%out.print(vLink1);%>");
						submenu2.addItem("<%out.print(sGroup3[2]);%>", "<%out.print(vLink1);%>" + "&functionCode=<%=sGroup3[1]%>");
						//******************************************************************************
<%				
					} else if ((vCurrParent != null) && (sGroup3[3] != null) && (vCurrParent.equals (sGroup3[3]))) {
						vSecondLevel = "N" ;
					}
				} // vLevel3 for loop ends

%>
				//******************************************************************************
				// JavaScript code - 
				/* if (submenu2 != null)
					submenu.makeLastSubmenu(submenu2); */
					if (submenu != null)
						menu.makeLastSubmenu(submenu);
				//******************************************************************************
<%				
			}
		}  // vLevel2 for loop ends
%>		//   //add new
		if ((vSecondLevel != null) && (vSecondLevel.equals ("N"))) {	

			for(int k = 0; k < vLevel3.size(); k++) {
				String sGroup3[] = new String[7] ;
				sGroup3 = (String[]) vLevel3.get(k) ;
				if ((vCurrParent != null) && (sGroup3[3] != null) && (vCurrParent.equals (sGroup3[3]))) {
					int iii= 0 ;
					iii = sGroup3[4].indexOf ("parent.tr.location=") ;
					if (iii == 0) iii = 21 ;
					if (iii < 0) iii = 0 ;
					vLink1 = sGroup3[4].substring (iii) ;
					if (iii == 21) 
						vLink1 = vLink1.substring (0, (vLink1.length ()- 2)) ;
%>
					//******************************************************************************
					// JavaScript code - 
					submenu.addItem("<%out.print(sGroup3[2]);%>", "<%out.print(vLink1);%>" + "&functionCode=<%=sGroup3[1]%>");
					//******************************************************************************
<%				
				} // vLevel3's if ends
			} // vLevel3 for loop ends
		} // if ends
%>
		//******************************************************************************
		// JavaScript code - 
		//menu.makeLastSubmenu(submenu);
		//menu.makeLastSubmenu(menu);
		//******************************************************************************
<%
	} // vLevel1 for loop ends
%>	   	
</SCRIPT> --%>





                </span>
            </td>
        </tr>
    </table>
    
    
 
</body>
</html>
